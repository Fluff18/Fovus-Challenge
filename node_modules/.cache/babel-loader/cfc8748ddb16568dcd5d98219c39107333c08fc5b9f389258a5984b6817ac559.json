{"ast":null,"code":"var util = require('../util');\nvar Rest = require('./rest');\nvar Json = require('./json');\nvar JsonBuilder = require('../json/builder');\nvar JsonParser = require('../json/parser');\nfunction populateBody(req) {\n  var builder = new JsonBuilder();\n  var input = req.service.api.operations[req.operation].input;\n  if (input.payload) {\n    var params = {};\n    var payloadShape = input.members[input.payload];\n    params = req.params[input.payload];\n    if (params === undefined) return;\n    if (payloadShape.type === 'structure') {\n      req.httpRequest.body = builder.build(params, payloadShape);\n    } else {\n      // non-JSON payload\n      req.httpRequest.body = params;\n    }\n  } else {\n    req.httpRequest.body = builder.build(req.params, input);\n  }\n}\nfunction buildRequest(req) {\n  Rest.buildRequest(req);\n\n  // never send body payload on GET/HEAD/DELETE\n  if (['GET', 'HEAD', 'DELETE'].indexOf(req.httpRequest.method) < 0) {\n    populateBody(req);\n  }\n}\nfunction extractError(resp) {\n  Json.extractError(resp);\n}\nfunction extractData(resp) {\n  Rest.extractData(resp);\n  var req = resp.request;\n  var rules = req.service.api.operations[req.operation].output || {};\n  if (rules.payload) {\n    var payloadMember = rules.members[rules.payload];\n    var body = resp.httpResponse.body;\n    if (payloadMember.type === 'structure' || payloadMember.type === 'list') {\n      var parser = new JsonParser();\n      resp.data[rules.payload] = parser.parse(body, payloadMember);\n    } else if (payloadMember.type === 'binary' || payloadMember.isStreaming) {\n      resp.data[rules.payload] = body;\n    } else {\n      resp.data[rules.payload] = payloadMember.toType(body);\n    }\n  } else {\n    var data = resp.data;\n    Json.extractData(resp);\n    resp.data = util.merge(data, resp.data);\n  }\n}\nmodule.exports = {\n  buildRequest: buildRequest,\n  extractError: extractError,\n  extractData: extractData\n};","map":{"version":3,"names":["util","require","Rest","Json","JsonBuilder","JsonParser","populateBody","req","builder","input","service","api","operations","operation","payload","params","payloadShape","members","undefined","type","httpRequest","body","build","buildRequest","indexOf","method","extractError","resp","extractData","request","rules","output","payloadMember","httpResponse","parser","data","parse","isStreaming","toType","merge","module","exports"],"sources":["/Users/luminosity/Desktop/Fovus/node_modules/aws-sdk/lib/protocol/rest_json.js"],"sourcesContent":["var util = require('../util');\nvar Rest = require('./rest');\nvar Json = require('./json');\nvar JsonBuilder = require('../json/builder');\nvar JsonParser = require('../json/parser');\n\nfunction populateBody(req) {\n  var builder = new JsonBuilder();\n  var input = req.service.api.operations[req.operation].input;\n\n  if (input.payload) {\n    var params = {};\n    var payloadShape = input.members[input.payload];\n    params = req.params[input.payload];\n    if (params === undefined) return;\n\n    if (payloadShape.type === 'structure') {\n      req.httpRequest.body = builder.build(params, payloadShape);\n    } else { // non-JSON payload\n      req.httpRequest.body = params;\n    }\n  } else {\n    req.httpRequest.body = builder.build(req.params, input);\n  }\n}\n\nfunction buildRequest(req) {\n  Rest.buildRequest(req);\n\n  // never send body payload on GET/HEAD/DELETE\n  if (['GET', 'HEAD', 'DELETE'].indexOf(req.httpRequest.method) < 0) {\n    populateBody(req);\n  }\n}\n\nfunction extractError(resp) {\n  Json.extractError(resp);\n}\n\nfunction extractData(resp) {\n  Rest.extractData(resp);\n\n  var req = resp.request;\n  var rules = req.service.api.operations[req.operation].output || {};\n  if (rules.payload) {\n    var payloadMember = rules.members[rules.payload];\n    var body = resp.httpResponse.body;\n    if (payloadMember.type === 'structure' || payloadMember.type === 'list') {\n      var parser = new JsonParser();\n      resp.data[rules.payload] = parser.parse(body, payloadMember);\n    } else if (payloadMember.type === 'binary' || payloadMember.isStreaming) {\n      resp.data[rules.payload] = body;\n    } else {\n      resp.data[rules.payload] = payloadMember.toType(body);\n    }\n  } else {\n    var data = resp.data;\n    Json.extractData(resp);\n    resp.data = util.merge(data, resp.data);\n  }\n}\n\nmodule.exports = {\n  buildRequest: buildRequest,\n  extractError: extractError,\n  extractData: extractData\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}